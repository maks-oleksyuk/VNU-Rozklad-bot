import json
from os import getenv

from api.timetable_api import get_chair, get_faculties

chair, faculty = [], []
week = ['–ü–æ–Ω–µ–¥—ñ–ª–æ–∫', '–í—ñ–≤—Ç–æ—Ä–æ–∫', '–°–µ—Ä–µ–¥–∞', '–ß–µ—Ç–≤–µ—Ä', "–ü'—è—Ç–Ω–∏—Ü—è", '–°—É–±–æ—Ç–∞', '–ù–µ–¥—ñ–ª—è'] * 2

message = {
    'start': "üëã *–ü—Ä–∏–≤—ñ—Ç\\!*\n\n"
             + "*–Ø* ‚Äì ü§ñ –ø–æ–º—ñ—á–Ω–∏–∫, —É —è–∫–æ–≥–æ,\n"
             + "—Ç–∏ –∑–∞–≤–∂–¥–∏ –º–æ–∂–µ—à –¥—ñ–∑–Ω–∞—Ç–∏—Å—å,\n"
             + "—è–∫—ñ –≤ —Ç–µ–±–µ –ø–∞—Ä–∏ –ø—Ä–æ—Ç—è–≥–æ–º —Ç–∏–∂–Ω—è\\.\n\n"
             + "ü¶æ –û–±–µ—Ä–∏ –¥–ª—è –∫–æ–≥–æ –±—É–¥–µ–º–æ —Ñ–æ—Ä–º—É–≤–∞—Ç–∏\n"
             + "—Ä–æ–∑–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –º–µ–Ω—é –∑–Ω–∏–∑—É:\n\n"
             + "‚ùï–Ø–∫—â–æ –º–µ–Ω—é –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–µ, –Ω–∞—Ç–∏—Å–Ω–∏ –Ω–∞ *‚åò*",

    'help': "‚ú≥Ô∏è __*–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Ä–æ–∑–∫–ª–∞–¥—É –ø–æ—Ç—Ä—ñ–±–Ω–æ\\:*__\n\n"
            + "*1\\.* –û–±—Ä–∞—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é –¥–ª—è –∫–æ–≥–æ —Ñ–æ—Ä–º—É–≤–∞—Ç–∏ —Ä–æ–∑–∫–ª–∞–¥\n"
            + "*2\\.* –û–±—Ä–∞—Ç–∏ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –¥–∞–Ω—ñ, –∞–±–æ —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—å –ø–æ—à—É–∫–æ–º\n\n"
            + "‚ö†Ô∏è –Ø–∫—â–æ –ø–æ–º–∏–ª–∏–≤—Å—è –∞–±–æ –ø–µ—Ä–µ–¥—É–º–∞–≤, —ñ—Å–Ω—É—î –∫–æ–º–∞–Ω–¥–∞ /cancel\n\n"
            + "‚ùï–Ø–∫—â–æ –º–µ–Ω—é –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–µ –Ω–∞—Ç–∏—Å–Ω–∏ –Ω–∞ *‚åò*",

    'about': "ü§ñ –ë–æ—Ç, –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ –ø–µ—Ä–µ–≥–ª—è–¥—É —Ä–æ–∑–∫–ª–∞–¥—É VNU\n\n"
             + "üë®üèº‚Äçüíª –ë–æ—Ç –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ —Ä–æ–∑—Ä–æ–±—Ü—ñ, —Ç–æ–º—É,\n"
             + "—è–∫—â–æ –≤–∏–Ω–∏–∫–Ω—É—Ç—å —è–∫—ñ—Å—å –ø—Ä–æ–±–ª–µ–º–∏ –∞–±–æ –ø–∏—Ç–∞–Ω–Ω—è\n"
             + "–Ω–µ —Å–æ—Ä–æ–º—Å—è, –ø–∏—à–∏ [—Å—é–¥–∏](tg://user?id=" + str(getenv("ADMIN_ID")) + "), –≤—ñ–Ω –¥–æ–ø–æ–º–æ–∂–µ üòé\n\n"
             + "*üé® –í–µ–ª–∏–∫–µ –¥—è–∫—É—é* [Tim Boniuk](https://t.me/timboniuk) –∑–∞ —á—É–¥–æ–≤–∏–π –∞–≤–∞—Ç–∞—Ä\n\n"
             + "[üá∫üá¶ –ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ –ó–°–£](https://savelife.in.ua/donate/)"
}


async def get_message_by_key(key: str) -> str:
    return message.get(key, '‚è≥')


async def departments_init():
    await get_chair()
    with open('./../json/chair.min.json') as f:
        text = json.loads(f.read())
    for d in text['psrozklad_export']['departments']:
        chair.append(d['name'])

    await get_faculties()
    with open('./../json/faculties.min.json') as f:
        text = json.loads(f.read())
        for d in text['psrozklad_export']['departments']:
            faculty.append(d['name'])
